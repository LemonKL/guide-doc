<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/yinzhengjie/p/9280564.html">Java基础-类加载机制与自定义类Java类加载器（ClassLoader）</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body"><p><span style="font-size: 18pt;">　　<strong>　　　　　　　Java基础-类加载机制与自定义类Java类加载器（ClassLoader）</strong></span></p>
<p><span style="font-size: 18pt;"><strong>　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　作者：尹正杰<br></strong></span></p>
<p><span style="font-size: 18pt;"><strong>版权声明：原创作品，谢绝转载！否则将追究法律责任。</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 14pt;">　　关于类加载器的概念和分类我就不再废话了，因为我在之前的笔记已经提到过了，详细能看到这篇文章的这些概念应该都烂熟于胸啦！如果你是一名小白的话可以参考我以前的笔记：https://www.cnblogs.com/yinzhengjie/p/9272289.html。本篇博客的重点侧重三点，第一，测试静态代码块；第二，编写自定义类加载器；第三，验证<strong>四级类加载机制。</strong></span></strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff00ff;"><strong><span style="font-size: 14pt;">一.测试静态代码块</span></strong></span></p>
<p><strong><span style="font-size: 18px;">1&gt;.静态代码块的作用</span></strong></p>
<p><strong><span style="font-size: 18px;">　　答：静态代码块的作用说白了跟构造方法的功能类似，他们都可以给类的成员变量进行赋值操作，我们可以简单的理解为静态代码块是为了给类初始化，构造方法是为了给对象初始化。</span></strong></p>
<p><strong><span style="font-size: 18px;">2&gt;.静态代码块在加载类的必须会被执行吗？</span></strong></p>
<p><strong><span style="font-size: 18px;">　　答：答案是否定的，我们在加载类的时候，可以不指定加载静态代码块。但是，只要你新建一个实例或者是通过反射的方式创建一个实例，依然还是会触发静态代码块的执行。我们在加载类是指定不加载静态代码块说白了只是延时它的加载，因为在实例化的过程中依然会加载！</span></strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('6269d541-30a7-4cde-b352-69ebccfc177e')"><img id="code_img_closed_6269d541-30a7-4cde-b352-69ebccfc177e" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="display: none;"><img id="code_img_opened_6269d541-30a7-4cde-b352-69ebccfc177e" class="code_img_opened" style="" onclick="cnblogs_code_hide('6269d541-30a7-4cde-b352-69ebccfc177e',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="">
<div id="cnblogs_code_open_6269d541-30a7-4cde-b352-69ebccfc177e" class="cnblogs_code_hide" style="display: block;"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">@author :yinzhengjie
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">Blog:</span><span style="color: #008000; text-decoration: underline;">http://www.cnblogs.com/yinzhengjie/tag/Java%E5%9F%BA%E7%A1%80/</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">EMAIL:y1053419035@qq.com
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 6</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> cn.org.yinzhengjie.jvm;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Person {
</span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String name;
</span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> age;
</span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String sex;
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span>     <span style="color: #0000ff;">static</span><span style="color: #000000;"> {
</span><span style="color: #008080;">14</span>         System.out.println("I'm yinzhengjie !!!"<span style="color: #000000;">);
</span><span style="color: #008080;">15</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> Person(String name, <span style="color: #0000ff;">int</span><span style="color: #000000;"> age, String sex) {
</span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">this</span>.age =<span style="color: #000000;"> age;
</span><span style="color: #008080;">20</span>         <span style="color: #0000ff;">this</span>.sex =<span style="color: #000000;"> sex;
</span><span style="color: #008080;">21</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">22</span> 
<span style="color: #008080;">23</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Person() { }
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getName() {
</span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
</span><span style="color: #008080;">27</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">28</span> 
<span style="color: #008080;">29</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setName(String name) {
</span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">31</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">32</span> 
<span style="color: #008080;">33</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getAge() {
</span><span style="color: #008080;">34</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> age;
</span><span style="color: #008080;">35</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">36</span> 
<span style="color: #008080;">37</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setAge(<span style="color: #0000ff;">int</span><span style="color: #000000;"> age) {
</span><span style="color: #008080;">38</span>         <span style="color: #0000ff;">this</span>.age =<span style="color: #000000;"> age;
</span><span style="color: #008080;">39</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">40</span> 
<span style="color: #008080;">41</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getSex() {
</span><span style="color: #008080;">42</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> sex;
</span><span style="color: #008080;">43</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">44</span> 
<span style="color: #008080;">45</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setSex(String sex) {
</span><span style="color: #008080;">46</span>         <span style="color: #0000ff;">this</span>.sex =<span style="color: #000000;"> sex;
</span><span style="color: #008080;">47</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">48</span> 
<span style="color: #008080;">49</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">50</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String toString() {
</span><span style="color: #008080;">51</span>         <span style="color: #0000ff;">return</span> "Person{" + "name='" + name + '\'' + ", age=" + age + ", sex='" + sex + '\'' + '}'<span style="color: #000000;">;
</span><span style="color: #008080;">52</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">53</span> }</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<span class="cnblogs_code_collapse" style="display: none;">Person.java 文件内容</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('be00f265-b0ac-4231-aed6-f658a4cf9a9a')"><img id="code_img_closed_be00f265-b0ac-4231-aed6-f658a4cf9a9a" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="display: none;"><img id="code_img_opened_be00f265-b0ac-4231-aed6-f658a4cf9a9a" class="code_img_opened" style="" onclick="cnblogs_code_hide('be00f265-b0ac-4231-aed6-f658a4cf9a9a',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="">
<div id="cnblogs_code_open_be00f265-b0ac-4231-aed6-f658a4cf9a9a" class="cnblogs_code_hide" style="display: block;"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">@author :yinzhengjie
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">Blog:</span><span style="color: #008000; text-decoration: underline;">http://www.cnblogs.com/yinzhengjie/tag/Java%E5%9F%BA%E7%A1%80/</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">EMAIL:y1053419035@qq.com
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> cn.org.yinzhengjie.jvm;
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.junit.Test;
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Field;
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestJVM {
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span> <span style="color: #000000;">    @Test
</span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> testClassLoader() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
</span><span style="color: #008080;">17</span>         <span style="color: #008000;">//</span><span style="color: #008000;">通过ClassLoader.getSystemClassLoader()获取系统加载类，将类的初始化操作设置为false.</span>
<span style="color: #008080;">18</span>         Class c1 = Class.forName("cn.org.yinzhengjie.jvm.Person",<span style="color: #0000ff;">false</span><span style="color: #000000;">,ClassLoader.getSystemClassLoader());
</span><span style="color: #008080;">19</span>         Field name = c1.getDeclaredField("name"<span style="color: #000000;">);
</span><span style="color: #008080;">20</span> <span style="color: #000000;">        System.out.println(name);
</span><span style="color: #008080;">21</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">22</span> <span style="color: #000000;">}
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;">25</span> <span style="color: #008000;">以上代码输出结果如下:
</span><span style="color: #008080;">26</span> <span style="color: #008000;">public java.lang.String cn.org.yinzhengjie.jvm.Person.name
</span><span style="color: #008080;">27</span> <span style="color: #008000;">*/</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<span class="cnblogs_code_collapse" style="display: none;">TestJVM.java 文件内容（不指定加载静态代码块）</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('f8ecae4f-5f0a-4c62-997d-3ff7b747c88b')"><img id="code_img_closed_f8ecae4f-5f0a-4c62-997d-3ff7b747c88b" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="display: none;"><img id="code_img_opened_f8ecae4f-5f0a-4c62-997d-3ff7b747c88b" class="code_img_opened" style="" onclick="cnblogs_code_hide('f8ecae4f-5f0a-4c62-997d-3ff7b747c88b',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="">
<div id="cnblogs_code_open_f8ecae4f-5f0a-4c62-997d-3ff7b747c88b" class="cnblogs_code_hide" style="display: block;"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">@author :yinzhengjie
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">Blog:</span><span style="color: #008000; text-decoration: underline;">http://www.cnblogs.com/yinzhengjie/tag/Java%E5%9F%BA%E7%A1%80/</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">EMAIL:y1053419035@qq.com
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> cn.org.yinzhengjie.jvm;
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.junit.Test;
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Field;
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestJVM {
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span> <span style="color: #000000;">    @Test
</span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> testClassLoader() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
</span><span style="color: #008080;">17</span>         <span style="color: #008000;">//</span><span style="color: #008000;">通过ClassLoader.getSystemClassLoader()获取系统加载类，将类的初始化操作设置为false.</span>
<span style="color: #008080;">18</span>         Class c1 = Class.forName("cn.org.yinzhengjie.jvm.Person",<span style="color: #0000ff;">false</span><span style="color: #000000;">,ClassLoader.getSystemClassLoader());
</span><span style="color: #008080;">19</span>         Field field = c1.getDeclaredField("name"<span style="color: #000000;">);
</span><span style="color: #008080;">20</span> <span style="color: #000000;">        System.out.println(field);
</span><span style="color: #008080;">21</span>         <span style="color: #008000;">//</span><span style="color: #008000;">虽然上面的代码再加载类的过程中设置禁用静态代码块的加载，通过反射获取到的时候依然会触发静态代码块的执行！</span>
<span style="color: #008080;">22</span>         Object obj =<span style="color: #000000;"> c1.newInstance();
</span><span style="color: #008080;">23</span>         field.set(obj,"尹正杰"<span style="color: #000000;">);
</span><span style="color: #008080;">24</span> <span style="color: #000000;">        System.out.println(obj);
</span><span style="color: #008080;">25</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">26</span> <span style="color: #000000;">}
</span><span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;">29</span> <span style="color: #008000;">以上代码输出结果如下:
</span><span style="color: #008080;">30</span> <span style="color: #008000;">public java.lang.String cn.org.yinzhengjie.jvm.Person.name
</span><span style="color: #008080;">31</span> <span style="color: #008000;">I'm yinzhengjie !!!
</span><span style="color: #008080;">32</span> <span style="color: #008000;">Person{name='尹正杰', age=0, sex='null'}
</span><span style="color: #008080;">33</span>  <span style="color: #008000;">*/</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<span class="cnblogs_code_collapse" style="display: none;">TestJVM.java 文件内容（反射触发静态代码块的执行）</span></div>
<p>&nbsp;</p>
<p><span style="color: #ff00ff;"><strong><span style="font-size: 14pt;">二.<strong>编写自定义类加载器</strong></span></strong></span></p>
<p><strong><span style="font-size: 18px;">1&gt;.编写自定义类加载器</span></strong></p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">@author :yinzhengjie
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">Blog:</span><span style="color: #008000; text-decoration: underline;">http://www.cnblogs.com/yinzhengjie/tag/Java%E5%9F%BA%E7%A1%80/</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">EMAIL:y1053419035@qq.com
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 6</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> cn.org.yinzhengjie.jvm;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.ByteArrayOutputStream;
</span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.FileInputStream;
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">12</span> <span style="color: #008000;"> * 自定义ClassLoader
</span><span style="color: #008080;">13</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">14</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyClassLoader <span style="color: #0000ff;">extends</span><span style="color: #000000;"> ClassLoader {
</span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">protected</span> Class&lt;?&gt;<span style="color: #000000;"> findClass(String name) {
</span><span style="color: #008080;">16</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;">17</span>             String path = "D:\\BigData\\JavaSE\\yinzhengjieData\\" + name + ".class"<span style="color: #000000;"> ;
</span><span style="color: #008080;">18</span>             FileInputStream in = <span style="color: #0000ff;">new</span><span style="color: #000000;"> FileInputStream(path) ;
</span><span style="color: #008080;">19</span>             ByteArrayOutputStream baos = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ByteArrayOutputStream() ;
</span><span style="color: #008080;">20</span>             <span style="color: #0000ff;">byte</span>[] buf = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[1024<span style="color: #000000;">] ;
</span><span style="color: #008080;">21</span>             <span style="color: #0000ff;">int</span> len = -1<span style="color: #000000;"> ;
</span><span style="color: #008080;">22</span>             <span style="color: #0000ff;">while</span>((len = in.read(buf)) != -1<span style="color: #000000;">){
</span><span style="color: #008080;">23</span>                 baos.write(buf , 0<span style="color: #000000;"> , len);
</span><span style="color: #008080;">24</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">25</span> <span style="color: #000000;">            in.close();
</span><span style="color: #008080;">26</span>             <span style="color: #0000ff;">byte</span>[] classBytes =<span style="color: #000000;"> baos.toByteArray();
</span><span style="color: #008080;">27</span>             <span style="color: #0000ff;">return</span> defineClass(classBytes , 0<span style="color: #000000;"> , classBytes.length) ;
</span><span style="color: #008080;">28</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {
</span><span style="color: #008080;">29</span> <span style="color: #000000;">            e.printStackTrace();
</span><span style="color: #008080;">30</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;"> ;
</span><span style="color: #008080;">32</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">33</span> }</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong><span style="font-size: 18px;">2&gt;.调用自定义类加载器</span></strong></p>
<p><strong><span style="font-size: 18px;">　　在“D:\BigData\JavaSE\yinzhengjieData”目录下编写测试代码如下：</span></strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('670af1ba-635b-4b98-aa0d-c0a1a57a2955')"><img id="code_img_closed_670af1ba-635b-4b98-aa0d-c0a1a57a2955" class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="display: none;"><img id="code_img_opened_670af1ba-635b-4b98-aa0d-c0a1a57a2955" class="code_img_opened" style="" onclick="cnblogs_code_hide('670af1ba-635b-4b98-aa0d-c0a1a57a2955',event)" src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="">
<div id="cnblogs_code_open_670af1ba-635b-4b98-aa0d-c0a1a57a2955" class="cnblogs_code_hide" style="display: block;"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">@author :yinzhengjie
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">Blog:</span><span style="color: #008000; text-decoration: underline;">http://www.cnblogs.com/yinzhengjie/tag/Java%E5%9F%BA%E7%A1%80/</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">EMAIL:y1053419035@qq.com
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Yinzhengjie {
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;
</span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> age;
</span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">static</span><span style="color: #000000;"> {
</span><span style="color: #008080;">11</span>         System.out.println("I'm yinzhengjie !"<span style="color: #000000;">);
</span><span style="color: #008080;">12</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">13</span> 
<span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span> Yinzhengjie(String name, <span style="color: #0000ff;">int</span><span style="color: #000000;"> age) {
</span><span style="color: #008080;">15</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">16</span>         <span style="color: #0000ff;">this</span>.age =<span style="color: #000000;"> age;
</span><span style="color: #008080;">17</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Yinzhengjie() {
</span><span style="color: #008080;">20</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getName() {
</span><span style="color: #008080;">23</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
</span><span style="color: #008080;">24</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setName(String name) {
</span><span style="color: #008080;">27</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">28</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getAge() {
</span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> age;
</span><span style="color: #008080;">32</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">33</span> 
<span style="color: #008080;">34</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setAge(<span style="color: #0000ff;">int</span><span style="color: #000000;"> age) {
</span><span style="color: #008080;">35</span>         <span style="color: #0000ff;">this</span>.age =<span style="color: #000000;"> age;
</span><span style="color: #008080;">36</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">37</span> 
<span style="color: #008080;">38</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">39</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String toString() {
</span><span style="color: #008080;">40</span>         <span style="color: #0000ff;">return</span> "Yinzhengjie{" + "Name = " + name + ", Age = " + age + '}'<span style="color: #000000;">;
</span><span style="color: #008080;">41</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">42</span> }</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<span class="cnblogs_code_collapse" style="display: none;">Yinzhengjie.java 文件内容</span></div>
<p><strong><span style="font-size: 18px;">　　使用javac命令编译Java代码。</span></strong></p>
<p><img src="https://images2018.cnblogs.com/blog/795254/201807/795254-20180708185155294-1479699667.png" alt=""></p>
<p><strong><span style="font-size: 18px;">　　调用咱们自定义的类加载器，测试代码如下：</span></strong></p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">@author :yinzhengjie
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">Blog:</span><span style="color: #008000; text-decoration: underline;">http://www.cnblogs.com/yinzhengjie/tag/Java%E5%9F%BA%E7%A1%80/</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">EMAIL:y1053419035@qq.com
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 6</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> cn.org.yinzhengjie.jvm;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Constructor;
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MyClassLoaderApp {
</span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;">12</span>         <span style="color: #008000;">//</span><span style="color: #008000;">创建自定义类加载器实例</span>
<span style="color: #008080;">13</span>         ClassLoader cl = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MyClassLoader() ;
</span><span style="color: #008080;">14</span> <span style="color: #000000;">        cl.getParent();
</span><span style="color: #008080;">15</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;">16</span>             Class clz = cl.loadClass("Yinzhengjie"<span style="color: #000000;">) ;
</span><span style="color: #008080;">17</span>             Constructor constructor = clz.getConstructor(String.<span style="color: #0000ff;">class</span>, <span style="color: #0000ff;">int</span>.<span style="color: #0000ff;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">18</span>             Object obj = constructor.newInstance("尹正杰", 18<span style="color: #000000;">);
</span><span style="color: #008080;">19</span> <span style="color: #000000;">            System.out.println(obj);
</span><span style="color: #008080;">20</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {
</span><span style="color: #008080;">21</span> <span style="color: #000000;">            e.printStackTrace();
</span><span style="color: #008080;">22</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">23</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">24</span> <span style="color: #000000;">}
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;">27</span> <span style="color: #008000;">以上代码执行结果如下:
</span><span style="color: #008080;">28</span> <span style="color: #008000;">I'm yinzhengjie !
</span><span style="color: #008080;">29</span> <span style="color: #008000;">Yinzhengjie{Name = 尹正杰, Age = 18}
</span><span style="color: #008080;">30</span>  <span style="color: #008000;">*/</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p>&nbsp;</p>
<p><span style="color: #ff00ff;"><strong><span style="font-size: 14pt;"><strong>三.验证<strong>四级类加载机制</strong></strong></span></strong></span></p>
<p><strong><span style="font-size: 18px;">1&gt;.<strong>根类加载器是得不到的</strong></span></strong></p>
<p>&nbsp;<img src="https://images2018.cnblogs.com/blog/795254/201807/795254-20180708204754454-1829008522.png" alt=""></p>
<p><strong><span style="font-size: 18px;">2&gt;.得到<strong>扩展类加载器</strong></span></strong></p>
<p>&nbsp;<img src="https://images2018.cnblogs.com/blog/795254/201807/795254-20180709085620424-803402245.png" alt=""></p>
<p><strong><span style="font-size: 18px;">3&gt;.得到<strong>系统类加载器</strong></span></strong></p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 18px;">4&gt;.得到自定义加载器</span></strong></p>
<p>&nbsp;</p></div><div id="MySignature" style="display: block;">当你的才华还撑不起你的野心的时候，你就应该静下心来学习。当你的能力还驾驭不了你的目标的时候，你就应该沉下心来历练。问问自己，想要怎样的人生。
	欢迎加入 基础架构自动化运维：598432640，大数据SRE进阶之路：959042252</div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag">标签: <a href="https://www.cnblogs.com/yinzhengjie/tag/Java%E5%9F%BA%E7%A1%80/">Java基础</a></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(9280564,cb_blogId,1);green_channel_success(this,'谢谢推荐！');">好文要顶</a>
            <a id="green_channel_follow" onclick="follow('7a8ea00a-413c-e511-b908-9dcfd8948a71');" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="//common.cnblogs.com/images/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="//common.cnblogs.com/images/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/yinzhengjie/" target="_blank"><img src="//pic.cnblogs.com/face/795254/20170821163121.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/yinzhengjie/">尹正杰</a><br>
            <a href="https://home.cnblogs.com/u/yinzhengjie/followees">关注 - 5</a><br>
            <a href="https://home.cnblogs.com/u/yinzhengjie/followers">粉丝 - 326</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow('7a8ea00a-413c-e511-b908-9dcfd8948a71');return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(9280564,'Digg')">
        <span class="diggnum" id="digg_count">0</span>
    </div>
    <div class="buryit" onclick="votePost(9280564,'Bury')">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
<script type="text/javascript">
    currentDiggType = 0;
</script></div>
<div class="clear"></div>
<div id="post_next_prev"><a href="https://www.cnblogs.com/yinzhengjie/p/9280036.html" class="p_n_p_prefix">« </a> 上一篇：<a href="https://www.cnblogs.com/yinzhengjie/p/9280036.html" title="发布于2018-07-08 14:54">Java基础-Java中的堆内存和离堆内存机制</a><br><a href="https://www.cnblogs.com/yinzhengjie/p/9282947.html" class="p_n_p_prefix">» </a> 下一篇：<a href="https://www.cnblogs.com/yinzhengjie/p/9282947.html" title="发布于2018-07-09 11:24">Java基础-SSM之mybatis快速入门篇</a><br></div>
</div>


</div>
<div class="postDesc">posted @ <span id="post-date">2018-07-08 17:04</span> <a href="https://www.cnblogs.com/yinzhengjie/">尹正杰</a> 阅读(<span id="post_view_count">159</span>) 评论(<span id="post_comment_count">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=9280564" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(9280564);return false;">收藏</a></div>
</div>